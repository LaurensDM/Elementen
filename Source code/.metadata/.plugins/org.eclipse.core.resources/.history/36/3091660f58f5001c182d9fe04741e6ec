package gui;

import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

import domein.DomeinController;
import javafx.animation.AnimationTimer;
import javafx.geometry.HPos;
import javafx.geometry.Insets;
import javafx.scene.Node;
import javafx.scene.control.Button;
import javafx.scene.control.Label;
import javafx.scene.layout.GridPane;

public class SageDialogue extends GridPane {

	private Button lvl1Skill = new Button("Learn");
	private Button lvl5Skill = new Button("Learn");
	private Button lvl10Skill = new Button("Learn");
	private Button lvl15Skill = new Button("Learn");
	private Button lvl20Skill = new Button("Learn");
	private Button lvl25Skill = new Button("Learn");
	private Button lvl30Skill = new Button("Learn");
	private Button lvl35Skill = new Button("Learn");
	private Button lvl40Skill = new Button("Learn");
	private Button lvl45Skill = new Button("Learn");
	private Button lvl50Skill = new Button("Learn");

	private List<Button> skillListBtn = new ArrayList<>();

	private Label lvl1SkillLbl = new Label("Improve mana efficiëncy");
	private Label lvl5SkillLbl = new Label("Improve accuracy");
	private Label lvl10SkillLbl = new Label("Improve mana density (power)");
	private Label lvl15SkillLbl = new Label("Improve mana efficiëncy II");
	private Label lvl20SkillLbl = new Label("Improve accuracy II");
	private Label lvl25SkillLbl = new Label("Improve mana density (power) II");
	private Label lvl30SkillLbl = new Label("Reflection shield");
	private Label lvl35SkillLbl = new Label("Improve mana efficiëncy III");
	private Label lvl40SkillLbl = new Label("Improve accuracy III");
	private Label lvl45SkillLbl = new Label("Improve mana density (power) III");
	private Label lvl50SkillLbl = new Label("Fusion Magic");

	List<Label> skillListlbl = new ArrayList<>();

	Label error = new Label();

	private int columnLabel = 0;
	private int columnButton = 1;
	private DomeinController dc;
	int lastRow = 0;

	AnimationTimer timer;
	private int teller = 0;

	public SageDialogue(DomeinController dc) {
		this.dc = dc;
		this.setVgap(10);
		this.setHgap(10);
		this.setPadding(new Insets(20));
		Collections.addAll(skillListBtn, lvl1Skill, lvl5Skill, lvl10Skill, lvl15Skill, lvl20Skill, lvl25Skill,
				lvl30Skill, lvl35Skill, lvl40Skill, lvl45Skill, lvl50Skill);

		Collections.addAll(skillListlbl, lvl1SkillLbl, lvl5SkillLbl, lvl10SkillLbl, lvl15SkillLbl, lvl20SkillLbl,
				lvl25SkillLbl, lvl30SkillLbl, lvl35SkillLbl, lvl40SkillLbl, lvl45SkillLbl, lvl50SkillLbl);

		for (int i = 0, row = 0; i < skillListBtn.size(); i++, row += 2) {
			if (i == 6) {
				columnButton = 3;
				columnLabel = 2;
				row = 0;
			}
			if (i > 5) {

				GridPane.setMargin(skillListlbl.get(i), new Insets(0, 0, 0, 20));
			}

			this.add(skillListBtn.get(i), columnButton, row);
			this.add(skillListlbl.get(i), columnLabel, row);

			Label label = new Label("oi");
			label.setVisible(true);
			GridPane.setColumnSpan(label, 2);
			this.add(label, columnLabel, row + 1);

			if (row > lastRow) {
				lastRow = row;
			}
		}

		GridPane.setColumnSpan(error, 4);
		GridPane.setHalignment(error, HPos.CENTER);
		this.add(error, 0, lastRow + 2);
		events();

		error.setVisible(false);

		for (Node node : this.getChildren()) {
			System.err.println(node);
		}
	}

	private void events() {

		// BUTTON EVENTS

		lvl1Skill.setOnAction(evt -> {
			error.setText("You have succesfully improved your mana efficiëncy!");
		});

		lvl5Skill.setOnAction(evt -> {
			if (dc.getPlayerLevel() < 5) {
				error.setVisible(true);
				error.setText(
						"It is too early for you to learn this technique, come back when you've reached level 5!");

				timer();

			} else {
				error.setText("You have succesfully improved your accuracy!");
			}

		});

		lvl10Skill.setOnAction(evt -> {
			if (dc.getPlayerLevel() < 10) {
				error.setVisible(true);
				error.setText(
						"It is too early for you to learn this technique, come back when you've reached level 10!");

				timer();

			} else {
				error.setText("You have succesfully improved your mana density!");
			}
		});

		lvl15Skill.setOnAction(evt -> {
			if (dc.getPlayerLevel() < 15) {
				error.setVisible(true);
				error.setText(
						"It is too early for you to learn this technique, come back when you've reached level 15!");

				timer();

			} else {
				error.setText("You have succesfully learned the intermediate level of mana efficiëncy!");
			}
		});

		lvl20Skill.setOnAction(evt -> {
			if (dc.getPlayerLevel() < 20) {
				error.setVisible(true);
				error.setText(
						"It is too early for you to learn this technique, come back when you've reached level 20!");

				timer();

			} else {
				error.setText("You have succesfully learned the intermediate level of accuracy!");
			}
		});

		lvl25Skill.setOnAction(evt -> {
			if (dc.getPlayerLevel() < 25) {
				error.setVisible(true);
				error.setText(
						"It is too early for you to learn this technique, come back when you've reached level 25!");

				timer();

			} else {
				error.setText("You have succesfully learned the intermediate level of mana density!");
			}
		});

		lvl30Skill.setOnAction(evt -> {
			if (dc.getPlayerLevel() < 30) {
				error.setVisible(true);
				error.setText(
						"It is too early for you to learn this technique, come back when you've reached level 30!");

				timer();

			} else {
				error.setText("You have succesfully learned the reflection shield!");
			}
		});

		lvl35Skill.setOnAction(evt -> {
			if (dc.getPlayerLevel() < 35) {
				error.setVisible(true);
				error.setText(
						"It is too early for you to learn this technique, come back when you've reached level 35!");

				timer();

			} else {
				error.setText("You have succesfully learned the advanced level of mana efficiëncy!");
			}
		});

		lvl40Skill.setOnAction(evt -> {
			if (dc.getPlayerLevel() < 40) {
				error.setVisible(true);
				error.setText(
						"It is too early for you to learn this technique, come back when you've reached level 40!");

				timer();

			} else {
				error.setText("You have succesfully learned the advanced level of accuracy!");
			}
		});

		lvl45Skill.setOnAction(evt -> {
			if (dc.getPlayerLevel() < 45) {
				error.setVisible(true);
				error.setText(
						"It is too early for you to learn this technique, come back when you've reached level 45!");

				timer();

			} else {
				error.setText("You have succesfully learned the advanced level of mana density!");
			}
		});

		lvl50Skill.setOnAction(evt -> {
			if (dc.getPlayerLevel() < 50) {
				error.setVisible(true);
				error.setText(
						"It is too early for you to learn this technique, come back when you've reached level 50!");

				timer();

			} else {
				error.setText("You have succesfully learned Fusion Magic");
			}
		});

		// lABEL EVENTS

		lvl1SkillLbl.setOnMouseEntered(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl1SkillLbl) + 2);
			label.setText("This skill will reduce the amount of mana spent per attack");
			label.setVisible(true);
		});

		lvl1SkillLbl.setOnMouseExited(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl1SkillLbl) + 2);
			label.setVisible(false);
		});

		lvl5SkillLbl.setOnMouseEntered(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl5SkillLbl) + 3);
			label.setText("This skill will decrease the chance of missing an attack!");
			label.setVisible(true);
		});

		lvl5SkillLbl.setOnMouseExited(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl5SkillLbl) + 3);
			label.setVisible(false);
		});
		lvl10SkillLbl.setOnMouseEntered(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl10SkillLbl) + 3);
			label.setText("This skill will increase your attack power!");
			label.setVisible(true);
		});

		lvl10SkillLbl.setOnMouseExited(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl10SkillLbl) + 3);
			label.setVisible(false);
		});
		lvl15SkillLbl.setOnMouseEntered(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl15SkillLbl) + 3);
			label.setText("This skill will highly reduce the amount of mana spent per attack!");
			label.setVisible(true);
		});

		lvl15SkillLbl.setOnMouseExited(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl15SkillLbl) + 3);
			label.setVisible(false);
		});
		lvl20SkillLbl.setOnMouseEntered(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl20SkillLbl) + 3);
			label.setText("This skill will highly decrease the chance of missing an attack!");
			label.setVisible(true);
		});

		lvl20SkillLbl.setOnMouseExited(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl20SkillLbl) + 3);
			label.setVisible(false);
		});
		lvl25SkillLbl.setOnMouseEntered(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl25SkillLbl) + 3);
			label.setText("This skill will highly increase your attack power!");
			label.setVisible(true);
		});

		lvl25SkillLbl.setOnMouseExited(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl25SkillLbl) + 3);
			label.setVisible(false);
		});
		lvl30SkillLbl.setOnMouseEntered(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl30SkillLbl) + 6 + 3);
			label.setText(
					"This skill has a chance to reflect the incoming damage back to the enemy, while taking no damage yourself!");
			label.setVisible(true);
		});

		lvl30SkillLbl.setOnMouseExited(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl30SkillLbl) + 6 + 3);
			label.setVisible(false);
		});
		lvl35SkillLbl.setOnMouseEntered(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl35SkillLbl) + 6 + 3);
			label.setText("This skill will greatly reduce the amount of mana spent per attack");
			label.setVisible(true);
		});

		lvl35SkillLbl.setOnMouseExited(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl35SkillLbl) + 6 + 3);
			label.setVisible(false);
		});
		lvl40SkillLbl.setOnMouseEntered(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl40SkillLbl) + 6 + 3);
			label.setText("This skill will greatly decrease the chance of missing an attack");
			label.setVisible(true);
		});

		lvl40SkillLbl.setOnMouseExited(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl40SkillLbl) + 6 + 3);
			label.setVisible(false);
		});
		lvl45SkillLbl.setOnMouseEntered(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl45SkillLbl) + 6 + 2);
			label.setText("This skill will greatly increase your attack power!");
			label.setVisible(true);
		});

		lvl45SkillLbl.setOnMouseExited(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl45SkillLbl) + 6 + 2);
			label.setVisible(false);
		});
		lvl50SkillLbl.setOnMouseEntered(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl50SkillLbl) + 6 + 3);
			label.setText("Fusion magic is the essence of magic, attack with a combination of every element!");
			label.setVisible(true);
		});

		lvl50SkillLbl.setOnMouseExited(evt -> {
			Label label = (Label) this.getChildren().get(GridPane.getRowIndex(lvl50SkillLbl) + 6 + 3);
			label.setVisible(false);
		});
	}

	private void timer() {

		if (timer != null) {
			timer.stop();
		}

		timer = new AnimationTimer() {

			@Override
			public void handle(long arg0) {
				teller++;
				if (teller == 300) {
					error.setVisible(false);
					teller = 0;
					timer.stop();
				}

			}
		};

		timer.start();
	}

}
